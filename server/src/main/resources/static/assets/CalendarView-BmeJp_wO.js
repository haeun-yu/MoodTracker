import{d as V,r as o,o as H,q as W,c as r,e,t as d,h as i,u as J,m as Q,F as w,x as C,f as $,w as R,y as U,s as T,n as Z,g as ee,z as te,A as se,i as L,p as le,j as ae,_ as ne}from"./index-BV9N32h3.js";import{c as g}from"./calendar-C2aMO7v8.js";import{C as N,D as oe,A as ce,p as ue,a as ie}from"./chart-CU4pDdqY.js";import{D as re}from"./DiaryModal-B-offEm6.js";const de={class:"relative flex flex-col items-center justify-center h-full rounded-lg"},_e={class:"absolute flex flex-col items-center justify-center inset-0 text-white w-[130px]"},ve={class:"text-2xl-bold"},he=V({__name:"DoughnutChart",props:{monthlyCount:{},endOfDay:{}},setup(x){N.register(oe,ce,ue,ie);const v=x,h=o(null);let p=null;const f=()=>{p&&p.destroy(),h.value&&(p=new N(h.value,{type:"doughnut",data:{datasets:[{data:[v.monthlyCount,v.endOfDay-v.monthlyCount],backgroundColor:["#a78bfa","#e5e7eb"],borderWidth:0,borderRadius:5}]},options:{cutout:"80%",rotation:-150,circumference:300,plugins:{legend:{display:!1},tooltip:{enabled:!1}}}}))};return H(()=>{f()}),W([()=>v.monthlyCount,()=>v.endOfDay],f),(b,l)=>(i(),r("div",de,[e("canvas",{ref_key:"doughnutChart",ref:h,class:"w-[130px]"},null,512),e("div",_e,[e("div",ve,d(b.monthlyCount)+"/"+d(b.endOfDay),1)])]))}}),_=x=>(le("data-v-e480c5b7"),x=x(),ae(),x),pe=_(()=>e("h1",{class:"text-4xl-bold mb-[10px]"},"Calendar",-1)),xe={class:"flex justify-between"},fe={class:"w-[70%] calendar-container"},me={class:"calendar-box"},ye={class:"text-center w-full"},ge={class:"th"},we=["onClick"],be={class:"w-full h-full flex flex-col justify-between p-[5px]"},Ce={class:"text-start text-sm-bold ml-[3px]"},De={class:"w-full flex items-center justify-center"},ke=["src"],$e=_(()=>e("span",null,null,-1)),Oe={class:"flex flex-col items-center gap-[20px] w-[27%]"},Me={class:"boxs w-full text-2xl-bold items-center"},je={class:"boxs text-base-medium"},Se=_(()=>e("p",null,"최장 연속 기록",-1)),Ae={class:"text-center"},Be={class:"boxs text-base-medium"},Ee=_(()=>e("p",null,"주간 평균 기록",-1)),Ie={class:"text-center"},Re={class:"boxs2 text-base-medium"},Te=_(()=>e("p",{class:"mb-[10px]"},"이달 작성 횟수",-1)),Le={class:"flex items-end justify-center"},Ne=_(()=>e("p",null,"회",-1)),Ve={class:"w-[28%]"},We={class:"flex flex-col gap-[13px] py-[10px] border-b-[1.5px] border-black"},Fe=_(()=>e("div",{class:"boxs text-2xl-bold text-center"},"이달의 감정",-1)),ze={class:"boxs2 gap-[15px]"},Ye=["src"],qe={class:"w-full"},Ke={class:"mt-[10px] w-full flex flex-col items-start gap-[20px] bg-white shadow-md p-[20px] rounded-[20px]"},Pe=_(()=>e("p",{class:"w-full flex justify-end text-[#B49BC5] text-xl-medium"}," 이 달의 리포트 분석이에요 ",-1)),Xe={class:"mt-[10px] w-full flex flex-col items-start gap-[20px] bg-[#B49BC5] shadow-md p-[20px] rounded-[20px]"},Ge=_(()=>e("p",{class:"w-full text-white text-xl-medium"},"오늘의 감정을 기록하세요",-1)),He={class:"w-full flex justify-end"},Je=2001,Qe=1,Ue=V({__name:"CalendarView",setup(x){Z();const{addToast:v}=J(),h=o(null),p=o([]),f=o(null),b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=o(0),s=o(0),m=o(null),O=o([]),M=o(0),j=o(0),S=o(0),A=o([]),B=o(),D=o(!1);Q(async()=>{}),W([l,s],async()=>{z(),await F()});const F=async()=>{O.value=await g.getDiaryList(m.value.name,`${l.value}-${s.value}`),A.value=await g.getEmotionCount(m.value.name,`${l.value}-${s.value}`),S.value=await g.getMonthlyCount(m.value.name,`${l.value}-${s.value}`),M.value=await g.getLongestConsecutive(m.value.name,`${l.value}-${s.value}`),j.value=await g.getWeeklyAverage(m.value.name,`${l.value}-${s.value}`)},z=()=>{f.value=q(l.value,s.value),h.value=k(l.value,s.value),Y()},Y=()=>{p.value=[];const a=Math.ceil((h.value+f.value)/7);let n=1;for(let c=0;c<a;c++){let t=[];for(let u=0;u<7;u++)c==0&&u<f.value?t.push(0):n<=h.value?(t.push(n),n++):t.push(0);p.value.push(t)}},k=(a,n)=>{switch(n){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 4:case 6:case 9:case 11:return 30;case 2:return a%4==0&&a%100!=0||a%400==0?29:28;default:return console.log("unknown month "+n),0}},q=(a,n)=>{let c=Je,t=1,u=Qe;for(;c<a||c===a&&t<n;)u+=k(c,t),t++,t>12&&(t=1,c++);return u%7},K=()=>{s.value===1?(l.value--,s.value=12):s.value--},P=()=>{s.value===12?(l.value++,s.value=1):s.value++},E=a=>a===0?null:O.value.find(c=>{const t=new Date(c.createdAt);return t.getFullYear()===l.value&&t.getMonth()+1===s.value&&t.getDate()===a})||null,X=async a=>{if(a===0)return;const n=await g.getDiary(m.value.name,`${l.value}-${s.value}-${a}`);n?(B.value=n,D.value=!0):v({message:"작성된 일기가 없습니다."})};return(a,n)=>{const c=ee("RouterLink");return i(),r(w,null,[e("div",null,[pe,e("div",xe,[e("section",fe,[e("article",me,[e("table",ye,[e("thead",null,[e("tr",null,[(i(),r(w,null,C(b,(t,u)=>e("th",{key:u,class:"text-sm-bold"},[e("p",ge,d(t),1)])),64))])]),e("tbody",null,[(i(!0),r(w,null,C(p.value,(t,u)=>(i(),r("tr",{key:u},[(i(!0),r(w,null,C(t,(y,G)=>{var I;return i(),r("td",{key:G,class:te(["td",y===0?"bg-[#DDDDDD]":"bg-white cursor-pointer"]),onClick:Ze=>X(y)},[e("div",be,[e("p",Ce,d(y!==0?y:""),1),e("div",De,[E(y)?(i(),r("img",{key:0,class:"w-[40%]",src:"/icons/emotions/"+((I=E(y))==null?void 0:I.emotion)+".svg",alt:"emotion"},null,8,ke)):T("",!0)]),$e])],10,we)}),128))]))),128))])])]),e("article",Oe,[e("div",Me,d(l.value)+"/"+d(s.value),1),e("div",{class:"w-full flex items-center gap-[10px] text-base-medium"},[e("button",{class:"boxs items-center",onClick:K},"지난 달"),e("button",{class:"boxs items-center",onClick:P},"다음 달")]),e("div",je,[Se,e("p",Ae,d(M.value)+"일",1)]),e("div",Be,[Ee,e("p",Ie,d(j.value)+"일",1)]),e("div",Re,[Te,e("div",Le,[$(he,{monthlyCount:S.value,endOfDay:k(l.value,s.value)},null,8,["monthlyCount","endOfDay"]),Ne])])])]),e("section",Ve,[e("article",We,[Fe,e("div",ze,[(i(!0),r(w,null,C(A.value,(t,u)=>(i(),r("div",{key:u,class:"flex items-center gap-[10px] px-[20px]"},[e("img",{class:"w-[40px]",src:"/icons/emotions/"+t.emotion+".svg",alt:"emotion"},null,8,Ye),e("div",qe,[e("div",{class:"bg-white h-[20px] rounded-r-[10px] mt-[5px]",style:se({width:t.count/30*100+"%"})},null,4),e("p",null,d(t.emotion)+"/"+d(t.count)+"회",1)])]))),128))])]),e("article",Ke,[Pe,$(c,{to:"/report/"+l.value+"-"+s.value,class:"btn-route"},{default:R(()=>[L("리포트 확인하기")]),_:1},8,["to"])]),e("article",Xe,[Ge,e("div",He,[$(c,{to:"/today",class:"btn-route2"},{default:R(()=>[L("기록하러 가기")]),_:1})])])])])]),D.value?(i(),U(re,{key:0,diary:B.value,onClose:n[0]||(n[0]=t=>D.value=!1)},null,8,["diary"])):T("",!0)],64)}}}),at=ne(Ue,[["__scopeId","data-v-e480c5b7"]]);export{at as default};
