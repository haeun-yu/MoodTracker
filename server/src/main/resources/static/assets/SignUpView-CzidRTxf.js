import{a as h}from"./auth-C_aZBYfv.js";import{e as b}from"./email-Dx53fGdD.js";import{d as k,u as U,r as n,k as N,l as I,n as A,c as V,b as e,e as d,q as P,t as B,m as M,g as w,p as z,i as L,_ as T}from"./index-DKyS1boa.js";import{_ as c}from"./CommonInput.vue_vue_type_script_setup_true_lang-C1L1GfBZ.js";const u=p=>(z("data-v-6b6c4eb2"),p=p(),L(),p),Z={class:"signup-body"},D={class:"w-[50%] flex flex-col items-center gap-[50px] pt-[50px] pb-[70px]"},R=u(()=>e("h1",{class:"text-3xl-bold"},"Sign Up",-1)),$={class:"w-full flex flex-col gap-[15px]"},j={class:"flex flex-col gap-[10px]"},q=u(()=>e("label",null,"Name",-1)),F={class:"flex flex-col gap-[10px]"},O=u(()=>e("label",null,"Email",-1)),G={class:"flex items-center gap-[10px]"},H=["disabled"],J={key:0,class:"flex items-center gap-[10px]"},K=["disabled"],Q={class:"flex flex-col gap-[10px]"},W=u(()=>e("label",null,"Password",-1)),X={class:"flex flex-col gap-[10px]"},Y=u(()=>e("label",null,"Confirm Password",-1)),ee={class:"text-[14px] text-[#8E46BD]"},se={class:"flex justify-end"},ae=["disabled"],le=k({__name:"SignUpView",setup(p){const x=M(),{addToast:o}=U(),s=n({userName:"",email:"",password:""}),r=n(""),m=n(""),f=n(""),i=n(!1),v=n(!1),_=n(!1),g=N(()=>!s.value.userName||!s.value.email||!s.value.password||!r.value),y=/^([0-9a-zA-Z_.-]+)@([0-9a-zA-Z_-]+)(\.[0-9a-zA-Z_-]+){1,2}$/;I(async()=>{try{(await h.checkLogin()).loggedIn&&(o({message:"로그인이 되어있습니다."}),x.push("/"))}catch(a){o({message:"서버에 문제가 발생했습니다. 다시 시도해주세요."}),console.error(a),i.value=!1}}),A(()=>r.value,a=>{a!==s.value.password?m.value="비밀번호가 일치하지 않습니다.":m.value=""});const C=async()=>{if(!y.test(s.value.email)||!s.value.email){o({message:"이메일을 올바르게 입력해주세요."});return}v.value=!0;try{const a={mail:s.value.email};await b.sendVerificationEmail(a)&&o({message:"인증 코드가 발송되었습니다. 메일을 확인해주세요."})}catch(a){o({message:"서버에 문제가 발생했습니다. 다시 시도해주세요."}),console.error(a),v.value=!1}},S=async()=>{if(!f.value){o({message:"인증 코드를 입력해주세요."});return}_.value=!0;try{const a={userNumber:f.value};await b.checkVerificationCode(a)&&o({message:"인증이 완료되었습니다."})}catch(a){o({message:"올바른 인증 번호를 입력해주세요."}),console.error(a),_.value=!1}},E=async()=>{if(!i.value){if(g.value){o({message:"모든 항목을 입력해주세요."});return}if(!_.value){o({message:"이메일 인증을 진행해주세요."});return}if(s.value.password!==r.value){m.value="비밀번호가 일치하지 않습니다.";return}i.value=!0;try{await h.signUp(s.value),x.push("/login")}catch(a){o({message:"회원가입에 실패했습니다. 다시 시도해주세요."}),console.error(a),i.value=!1}}};return(a,l)=>(w(),V("div",Z,[e("section",D,[R,e("article",$,[e("div",j,[q,d(c,{modelValue:s.value.userName,"onUpdate:modelValue":l[0]||(l[0]=t=>s.value.userName=t),placeholder:"Enter Email"},null,8,["modelValue"])]),e("div",F,[O,e("div",G,[d(c,{modelValue:s.value.email,"onUpdate:modelValue":l[1]||(l[1]=t=>s.value.email=t),placeholder:"Enter Email"},null,8,["modelValue"]),e("button",{class:"btn-primary p-[10px] text-sm",disabled:v.value,onClick:C}," Send ",8,H)]),v.value?(w(),V("div",J,[d(c,{modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=t=>f.value=t),placeholder:"Enter Verification Code"},null,8,["modelValue"]),e("button",{class:"btn-primary p-[10px] text-sm",disabled:_.value,onClick:S}," Confirm ",8,K)])):P("",!0)]),e("div",Q,[W,d(c,{modelValue:s.value.password,"onUpdate:modelValue":l[3]||(l[3]=t=>s.value.password=t),type:"password",placeholder:"Enter Password"},null,8,["modelValue"])]),e("div",X,[Y,d(c,{modelValue:r.value,"onUpdate:modelValue":l[4]||(l[4]=t=>r.value=t),type:"password",placeholder:"Enter Password"},null,8,["modelValue"]),e("p",ee,B(m.value),1)]),e("div",se,[e("button",{class:"btn-primary p-[10px]",onClick:E,disabled:i.value||g.value}," Submit ",8,ae)])])])]))}}),ie=T(le,[["__scopeId","data-v-6b6c4eb2"]]);export{ie as default};
