import{d as E,u as N,r as n,m as F,a as S,q as x,l as z,c as d,e,f as K,t as i,A as I,F as P,z as q,i as G,y as H,s as O,n as U,g as Y,h as r,p as J,j as Q,_ as W}from"./index-rlBB47KP.js";import{d as T}from"./diary-28Qgq9kd.js";import{_ as X}from"./CommonInput.vue_vue_type_script_setup_true_lang-C-SDlkUc.js";const V="/icons/page-nation-left.svg",p=_=>(J("data-v-cbfb17d3"),_=_(),Q(),_),Z={class:"w-full flex flex-col items-center justify-between border-b-[2px] border-black pb-[60px]"},ee=p(()=>e("h3",{class:"text-4xl-bold mb-[60px] text-[#222222]"},"SEARCH",-1)),te={class:"flex item-center gap-[10px] w-[80%]"},se={class:"w-full flex flex-col items-center justify-between pt-[10px]"},ae={key:0,class:"pt-[100px]"},le=p(()=>e("p",{class:"text-xl-regular"},"검색 결과가 없습니다.",-1)),oe=[le],ne={key:1,class:"w-full flex flex-col gap-[20px]"},ce={class:"flex items-center justify-between"},ie={class:"text-lg-bold"},re={class:"flex items-center gap-[10px]"},ue=p(()=>e("span",{class:"w-[5px] h-[5px] bg-black rounded-full"},null,-1)),de={class:"search-result-container"},pe=["onClick"],_e={class:"w-[10%]"},ve=["src"],ge={class:"w-[80%] ellipsis"},me={class:"w-full flex items-center justify-center gap-[10px]"},he=["disabled"],fe=p(()=>e("img",{src:V,class:"w-[30px]"},null,-1)),xe=[fe],be=["disabled"],we=p(()=>e("img",{src:V,class:"w-[30px] -scale-x-100"},null,-1)),ye=[we],b=10,ke=E({__name:"SearchView",setup(_){const w=U(),{addToast:y}=N(),c=n(!1),v=n(!1),f=n(null),u=n(""),a=n(1),g=n(1),m=n([]),l=n([]),k=n(null);F(async()=>{await S.checkLogin()||(y({message:"로그인이 필요합니다."}),w.push("/login"));const t=await S.getInformation();t||(y({message:"서버에 문제가 발생했습니다. 다시 시도해주세요."}),w.push("/")),f.value=t;const h=await T.searchDiaryByKeyword(f.value.name,"");console.log(h),m.value=h,l.value=m.value,A()}),x(c,()=>{D()}),x(u,()=>{C()}),x([l,a],()=>{A()});const $=s=>{const t=new Date(s);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`},D=()=>{l.value=c.value?l.value.sort((s,t)=>new Date(t.createdAt).getTime()-new Date(s.createdAt).getTime()):l.value.sort((s,t)=>new Date(s.createdAt).getTime()-new Date(t.createdAt).getTime())},C=async()=>{const s=await T.searchDiaryByKeyword(f.value.name,u.value);m.value=s,l.value=m.value.filter(t=>t.content.includes(u.value)),a.value=1,D()},A=()=>{g.value=Math.ceil(l.value.length/b)},B=z(()=>{const s=(a.value-1)*b;return l.value.slice(s,s+b)}),L=()=>{a.value>1&&(a.value-=1)},M=()=>{a.value<g.value&&(a.value+=1)},R=s=>{console.log(s),k.value=s,v.value=!0};return(s,t)=>{const h=Y("DiaryModal");return r(),d(P,null,[e("div",null,[e("section",Z,[ee,e("article",te,[K(X,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=o=>u.value=o)},null,8,["modelValue"]),e("button",{class:"btn-primary px-[30px] py-[10px] text-xl-bold",onClick:C}," 검색 ")])]),e("section",se,[l.value.length<=0?(r(),d("article",ae,oe)):(r(),d("article",ne,[e("div",ce,[e("label",ie,"검색 결과("+i(l.value.length)+")",1),e("div",re,[e("button",{class:I(c.value?"text-lg-bold":"text-lg-regular"),onClick:t[1]||(t[1]=o=>c.value=!0)}," 최신 순 ",2),ue,e("button",{class:I(c.value?"text-lg-regular":"text-lg-bold"),onClick:t[2]||(t[2]=o=>c.value=!1)}," 오래된 순 ",2)])]),e("div",de,[(r(!0),d(P,null,q(B.value,(o,j)=>(r(),d("div",{key:j,class:"search-result-list cursor-pointer",onClick:De=>R(o)},[e("p",_e,i($(o.createdAt)),1),e("img",{src:`/icons/emotions/${o.emotion}.svg`,alt:"emotion",class:"w-[2%]"},null,8,ve),e("p",ge,i(o.content),1)],8,pe))),128))]),e("div",me,[e("button",{onClick:L,disabled:a.value<=1},xe,8,he),e("span",null,i(a.value)+" / "+i(g.value),1),e("button",{onClick:M,disabled:a.value>=g.value},ye,8,be)])]))])]),G(" "+i(v.value)+" ",1),v.value?(r(),H(h,{key:0,diary:k.value,onClose:t[3]||(t[3]=o=>v.value=!1)},null,8,["diary"])):O("",!0)],64)}}}),Ie=W(ke,[["__scopeId","data-v-cbfb17d3"]]);export{Ie as default};
